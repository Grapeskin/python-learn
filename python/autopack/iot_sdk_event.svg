<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1581px" preserveAspectRatio="none" style="width:962px;height:1581px;background:#FFFFFF;" version="1.1" viewBox="0 0 962 1581" width="962px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="1569.7939" style="stroke:#181818;stroke-width:0.5;" width="595" x="255.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="56" x="525" y="20.8979">IOT_SDK</text><rect height="229.3267" style="stroke:#000000;stroke-width:1.5;fill:none;" width="607.5" x="10" y="372.9097"/><rect height="195.5723" style="stroke:#000000;stroke-width:1.5;fill:none;" width="587.5" x="20" y="399.6641"/><rect height="130.0635" style="stroke:#000000;stroke-width:1.5;fill:none;" width="521.5" x="30" y="458.1729"/><rect height="51.5317" style="stroke:#000000;stroke-width:1.5;fill:none;" width="430.5" x="40" y="529.7046"/><rect height="180.8408" style="stroke:#000000;stroke-width:1.5;fill:none;" width="816.5" x="40" y="1340.833"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="82" x2="82" y1="61.8745" y2="1538.6738"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="301.5" x2="301.5" y1="61.8745" y2="1538.6738"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="407.5" x2="407.5" y1="61.8745" y2="1538.6738"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="546.5" x2="546.5" y1="61.8745" y2="1538.6738"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="663.5" x2="663.5" y1="61.8745" y2="1538.6738"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="787.5" x2="787.5" y1="61.8745" y2="1538.6738"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="906" x2="906" y1="61.8745" y2="1538.6738"/><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="50" y="27.7544"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="57" y="50.7983">Network</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64" x="50" y="1537.6738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="57" y="1560.7178">Network</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="259.5" y="27.7544"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="266.5" y="50.7983">AposSdkIot</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="259.5" y="1537.6738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="266.5" y="1560.7178">AposSdkIot</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="354.5" y="27.7544"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="361.5" y="50.7983">EventManager</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="354.5" y="1537.6738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="361.5" y="1560.7178">EventManager</text><path d="M500.5,32.7544 L592.5,32.7544 C597.5,32.7544 597.5,47.3145 597.5,47.3145 C597.5,47.3145 597.5,61.8745 592.5,61.8745 L500.5,61.8745 C495.5,61.8745 495.5,47.3145 495.5,47.3145 C495.5,47.3145 495.5,32.7544 500.5,32.7544 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M592.5,32.7544 C587.5,32.7544 587.5,47.3145 587.5,47.3145 C587.5,61.8745 592.5,61.8745 592.5,61.8745 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="500.5" y="53.7983">SignalQueue</text><path d="M500.5,1537.6738 L592.5,1537.6738 C597.5,1537.6738 597.5,1552.2339 597.5,1552.2339 C597.5,1552.2339 597.5,1566.7939 592.5,1566.7939 L500.5,1566.7939 C495.5,1566.7939 495.5,1552.2339 495.5,1552.2339 C495.5,1552.2339 495.5,1537.6738 500.5,1537.6738 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M592.5,1537.6738 C587.5,1537.6738 587.5,1552.2339 587.5,1552.2339 C587.5,1566.7939 592.5,1566.7939 592.5,1566.7939 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="500.5" y="1558.7178">SignalQueue</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="607.5" y="27.7544"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="614.5" y="50.7983">ServerManager</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112" x="607.5" y="1537.6738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="614.5" y="1560.7178">ServerManager</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="729.5" y="27.7544"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="736.5" y="50.7983">ServiceManager</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="729.5" y="1537.6738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="736.5" y="1560.7178">ServiceManager</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="862" y="27.7544"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="869" y="50.7983">APOS_SDK</text><rect fill="#E2E2F0" height="33.1201" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="862" y="1537.6738"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="869" y="1560.7178">APOS_SDK</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="955" x="0" y="93.7517"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="955" y1="93.7517" y2="93.7517"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="955" y1="96.7517" y2="96.7517"/><rect fill="#EEEEEE" height="25.7544" style="stroke:#000000;stroke-width:2.0;" width="53" x="451" y="81.8745"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39" x="457" y="100.7725">初始化</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="82" x2="124" y1="141.3833" y2="141.3833"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="124" x2="124" y1="141.3833" y2="154.3833"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="83" x2="124" y1="154.3833" y2="154.3833"/><polygon fill="#181818" points="93,150.3833,83,154.3833,93,158.3833,89,154.3833" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="89" y="136.5269">节点启动</text><polygon fill="#181818" points="290,182.1377,300,186.1377,290,190.1377,294,186.1377" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="82" x2="296" y1="186.1377" y2="186.1377"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="89" y="181.2813">初始化SDK</text><polygon fill="#181818" points="894,213.8921,904,217.8921,894,221.8921,898,217.8921" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="302" x2="900" y1="217.8921" y2="217.8921"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="309" y="213.0356">初始化</text><polygon fill="#181818" points="313,245.6465,303,249.6465,313,253.6465,309,249.6465" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="307" x2="905" y1="249.6465" y2="249.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="319" y="244.79">初始化成功</text><polygon fill="#181818" points="395.5,277.4009,405.5,281.4009,395.5,285.4009,399.5,281.4009" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="302" x2="401.5" y1="281.4009" y2="281.4009"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="309" y="276.5444">初始化</text><polygon fill="#0000FF" points="894,309.1553,904,313.1553,894,317.1553,898,313.1553" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="407.5" x2="900" y1="313.1553" y2="313.1553"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="414.5" y="308.2988">订阅主题，egg: /WorkStatus/Idle</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="407.5" x2="449.5" y1="344.9097" y2="344.9097"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="449.5" x2="449.5" y1="344.9097" y2="357.9097"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="408.5" x2="449.5" y1="357.9097" y2="357.9097"/><polygon fill="#181818" points="418.5,353.9097,408.5,357.9097,418.5,361.9097,414.5,357.9097" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="414.5" y="340.0532">启动消费消息线程T1</text><path d="M10,372.9097 L96,372.9097 L96,382.6641 L86,392.6641 L10,392.6641 L10,372.9097 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="229.3267" style="stroke:#000000;stroke-width:1.5;" width="607.5" x="10" y="372.9097"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41" x="25" y="388.8076">线程T1</text><path d="M20,399.6641 L93,399.6641 L93,409.4185 L83,419.4185 L20,419.4185 L20,399.6641 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="195.5723" style="stroke:#000000;stroke-width:1.5;" width="587.5" x="20" y="399.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="35" y="415.562">loop</text><polygon fill="#FF0000" points="418.5,439.1729,408.5,443.1729,418.5,447.1729,414.5,443.1729" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="412.5" x2="545.5" y1="443.1729" y2="443.1729"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="424.5" y="438.3164">Pull(5s timeout)</text><path d="M30,458.1729 L91,458.1729 L91,467.9272 L81,477.9272 L30,477.9272 L30,458.1729 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="130.0635" style="stroke:#000000;stroke-width:1.5;" width="521.5" x="30" y="458.1729"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="45" y="474.0708">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="63" x="106" y="472.7788">[有事件处理]</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="407.5" x2="449.5" y1="501.7046" y2="501.7046"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="449.5" x2="449.5" y1="501.7046" y2="514.7046"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="408.5" x2="449.5" y1="514.7046" y2="514.7046"/><polygon fill="#181818" points="418.5,510.7046,408.5,514.7046,418.5,518.7046,414.5,514.7046" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="414.5" y="496.8481">匹配Network注册主题</text><path d="M40,529.7046 L101,529.7046 L101,539.459 L91,549.459 L40,549.459 L40,529.7046 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="51.5317" style="stroke:#000000;stroke-width:1.5;" width="430.5" x="40" y="529.7046"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="55" y="545.6025">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="52" x="116" y="544.3105">[匹配成功]</text><polygon fill="#FFA500" points="93,569.2363,83,573.2363,93,577.2363,89,573.2363" style="stroke:#FFA500;stroke-width:1.0;"/><line style="stroke:#FFA500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="87" x2="406.5" y1="573.2363" y2="573.2363"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="99" y="568.3799">执行回调函数</text><polygon fill="#181818" points="313,628.9907,303,632.9907,313,636.9907,309,632.9907" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="307" x2="406.5" y1="632.9907" y2="632.9907"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="319" y="628.1343">初始化成功</text><polygon fill="#181818" points="776,660.7451,786,664.7451,776,668.7451,780,664.7451" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="302" x2="782" y1="664.7451" y2="664.7451"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="309" y="659.8887">初始化</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="788" x2="830" y1="696.4995" y2="696.4995"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="830" x2="830" y1="696.4995" y2="709.4995"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="789" x2="830" y1="709.4995" y2="709.4995"/><polygon fill="#181818" points="799,705.4995,789,709.4995,799,713.4995,795,709.4995" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="795" y="691.6431">注册服务、初始化</text><polygon fill="#FF1493" points="418.5,737.2539,408.5,741.2539,418.5,745.2539,414.5,741.2539" style="stroke:#FF1493;stroke-width:1.0;"/><line style="stroke:#FF1493;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="412.5" x2="787" y1="741.2539" y2="741.2539"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="424.5" y="736.3975">注册事件回调</text><polygon fill="#181818" points="776,769.0083,786,773.0083,776,777.0083,780,773.0083" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="407.5" x2="782" y1="773.0083" y2="773.0083"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="414.5" y="768.1519">注册成功</text><polygon fill="#008000" points="674.5,800.7627,664.5,804.7627,674.5,808.7627,670.5,804.7627" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="668.5" x2="787" y1="804.7627" y2="804.7627"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="680.5" y="799.9063">注册请求回调</text><polygon fill="#181818" points="776,832.5171,786,836.5171,776,840.5171,780,836.5171" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="663.5" x2="782" y1="836.5171" y2="836.5171"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="670.5" y="831.6606">注册成功</text><polygon fill="#181818" points="313,864.2715,303,868.2715,313,872.2715,309,868.2715" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="307" x2="787" y1="868.2715" y2="868.2715"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="319" y="863.415">初始化成功</text><polygon fill="#181818" points="93,896.0259,83,900.0259,93,904.0259,89,900.0259" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="87" x2="301" y1="900.0259" y2="900.0259"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="99" y="895.1694">初始化成功</text><polygon fill="#FFA500" points="290,963.2891,300,967.2891,290,971.2891,294,967.2891" style="stroke:#FFA500;stroke-width:1.0;"/><line style="stroke:#FFA500;stroke-width:1.0;" x1="82" x2="296" y1="967.2891" y2="967.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="89" y="926.9238">注册事件回调 egg:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="89" y="944.6782">/Sweep/DevStatus(业务型)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="89" y="962.4326">/Common/TimeNtpUpdate(透传型)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="955" x="0" y="997.1663"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="955" y1="997.1663" y2="997.1663"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="955" y1="1000.1663" y2="1000.1663"/><rect fill="#EEEEEE" height="25.7544" style="stroke:#000000;stroke-width:2.0;" width="66" x="444.5" y="985.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52" x="450.5" y="1004.187">请求执行</text><polygon fill="#008000" points="290,1040.7979,300,1044.7979,290,1048.7979,294,1044.7979" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="82" x2="296" y1="1044.7979" y2="1044.7979"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="89" y="1039.9414">执行指令，egg: /Sweep/Volume</text><polygon fill="#008000" points="651.5,1072.5522,661.5,1076.5522,651.5,1080.5522,655.5,1076.5522" style="stroke:#008000;stroke-width:1.0;"/><line style="stroke:#008000;stroke-width:1.0;" x1="302" x2="657.5" y1="1076.5522" y2="1076.5522"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="309" y="1071.6958">执行指令</text><polygon fill="#181818" points="894,1104.3066,904,1108.3066,894,1112.3066,898,1108.3066" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="663.5" x2="900" y1="1108.3066" y2="1108.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="670.5" y="1103.4502">执行指令</text><polygon fill="#181818" points="674.5,1136.061,664.5,1140.061,674.5,1144.061,670.5,1140.061" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="668.5" x2="905" y1="1140.061" y2="1140.061"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="680.5" y="1135.2046">执行结果</text><polygon fill="#181818" points="313,1167.8154,303,1171.8154,313,1175.8154,309,1171.8154" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="307" x2="662.5" y1="1171.8154" y2="1171.8154"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="319" y="1166.959">执行结果</text><polygon fill="#181818" points="93,1199.5698,83,1203.5698,93,1207.5698,89,1203.5698" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="87" x2="301" y1="1203.5698" y2="1203.5698"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="99" y="1198.7134">执行结果</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="955" x="0" y="1233.447"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="955" y1="1233.447" y2="1233.447"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="955" y1="1236.447" y2="1236.447"/><rect fill="#EEEEEE" height="25.7544" style="stroke:#000000;stroke-width:2.0;" width="66" x="444.5" y="1221.5698"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52" x="450.5" y="1240.4678">事件上报</text><polygon fill="#0000FF" points="418.5,1277.0786,408.5,1281.0786,418.5,1285.0786,414.5,1281.0786" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="412.5" x2="905" y1="1281.0786" y2="1281.0786"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="424.5" y="1276.2222">事件触发</text><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="407.5" x2="449.5" y1="1312.833" y2="1312.833"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="449.5" x2="449.5" y1="1312.833" y2="1325.833"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="408.5" x2="449.5" y1="1325.833" y2="1325.833"/><polygon fill="#181818" points="418.5,1321.833,408.5,1325.833,418.5,1329.833,414.5,1325.833" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="414.5" y="1307.9766">匹配回调</text><path d="M40,1340.833 L101,1340.833 L101,1350.5874 L91,1360.5874 L40,1360.5874 L40,1340.833 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="180.8408" style="stroke:#000000;stroke-width:1.5;" width="816.5" x="40" y="1340.833"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="55" y="1356.731">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="77" x="116" y="1355.439">[匹配Network]</text><polygon fill="#FFA500" points="93,1380.3647,83,1384.3647,93,1388.3647,89,1384.3647" style="stroke:#FFA500;stroke-width:1.0;"/><line style="stroke:#FFA500;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="87" x2="406.5" y1="1384.3647" y2="1384.3647"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="99" y="1379.5083">执行回调函数</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="856.5" y1="1393.3647" y2="1393.3647"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="119" x="45" y="1405.9707">[匹配ServiceManager]</text><polygon fill="#FF1493" points="776,1429.1421,786,1433.1421,776,1437.1421,780,1433.1421" style="stroke:#FF1493;stroke-width:1.0;"/><line style="stroke:#FF1493;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="407.5" x2="782" y1="1433.1421" y2="1433.1421"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="414.5" y="1428.2856">执行回调函数</text><polygon fill="#FF0000" points="418.5,1460.8965,408.5,1464.8965,418.5,1468.8965,414.5,1464.8965" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="412.5" x2="787" y1="1464.8965" y2="1464.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="424.5" y="1460.04">发布到Network</text><polygon fill="#FF0000" points="534.5,1492.6509,544.5,1496.6509,534.5,1500.6509,538.5,1496.6509" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="407.5" x2="540.5" y1="1496.6509" y2="1496.6509"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="414.5" y="1491.7944">Push</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="40" x2="856.5" y1="1505.6509" y2="1505.6509"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="52" x="45" y="1518.2568">[匹配失败]</text><!--MD5=[8ae2d45530a680e18405eb61f902537e]
@startuml
participant Network
box IOT_SDK
participant AposSdkIot
participant EventManager
queue SignalQueue
participant ServerManager
participant ServiceManager
endbox
participant APOS_SDK

'autonumber
==初始化==
Network - -> Network: 节点启动
Network -> AposSdkIot: 初始化SDK
AposSdkIot -> APOS_SDK: 初始化
AposSdkIot <- - APOS_SDK: 初始化成功
AposSdkIot -> EventManager: 初始化

EventManager -[#blue]> APOS_SDK: 订阅主题，egg: /WorkStatus/Idle
EventManager - -> EventManager: 启动消费消息线程T1
group 线程T1
    loop
        EventManager <-[#red]- SignalQueue: Pull(5s timeout)
        alt 有事件处理
            EventManager - -> EventManager: 匹配Network注册主题
            alt 匹配成功
                Network <-[#orange]- EventManager: 执行回调函数
            end
        end
    end
end
AposSdkIot <- - EventManager: 初始化成功
AposSdkIot -> ServiceManager: 初始化
ServiceManager - -> ServiceManager: 注册服务、初始化
ServiceManager -[#deeppink]-> EventManager: 注册事件回调
ServiceManager <- - EventManager: 注册成功
ServiceManager -[#green]-> ServerManager: 注册请求回调
ServiceManager <- - ServerManager: 注册成功
AposSdkIot <- - ServiceManager: 初始化成功
Network <- - AposSdkIot: 初始化成功
Network -[#orange]> AposSdkIot: 注册事件回调 egg: \n/Sweep/DevStatus(业务型)\n/Common/TimeNtpUpdate(透传型)

==请求执行==
Network -[#green]> AposSdkIot: 执行指令，egg: /Sweep/Volume
AposSdkIot -[#green]> ServerManager: 执行指令
ServerManager -> APOS_SDK: 执行指令
ServerManager <- - APOS_SDK: 执行结果
AposSdkIot <- - ServerManager: 执行结果
Network <- - AposSdkIot: 执行结果
==事件上报==
APOS_SDK -[#blue]> EventManager: 事件触发
EventManager - -> EventManager: 匹配回调
alt 匹配Network
    EventManager -[#orange]-> Network: 执行回调函数
else 匹配ServiceManager
    EventManager -[#deeppink]-> ServiceManager: 执行回调函数
    ServiceManager -[#red]-> EventManager: 发布到Network
    EventManager -[#red]-> SignalQueue: Push
else 匹配失败

end
@enduml

@startuml
participant Network
box IOT_SDK
participant AposSdkIot
participant EventManager
queue SignalQueue
participant ServerManager
participant ServiceManager
endbox
participant APOS_SDK

==初始化==
Network - -> Network: 节点启动
Network -> AposSdkIot: 初始化SDK
AposSdkIot -> APOS_SDK: 初始化
AposSdkIot <- - APOS_SDK: 初始化成功
AposSdkIot -> EventManager: 初始化

EventManager -[#blue]> APOS_SDK: 订阅主题，egg: /WorkStatus/Idle
EventManager - -> EventManager: 启动消费消息线程T1
group 线程T1
    loop
        EventManager <-[#red]- SignalQueue: Pull(5s timeout)
        alt 有事件处理
            EventManager - -> EventManager: 匹配Network注册主题
            alt 匹配成功
                Network <-[#orange]- EventManager: 执行回调函数
            end
        end
    end
end
AposSdkIot <- - EventManager: 初始化成功
AposSdkIot -> ServiceManager: 初始化
ServiceManager - -> ServiceManager: 注册服务、初始化
ServiceManager -[#deeppink]-> EventManager: 注册事件回调
ServiceManager <- - EventManager: 注册成功
ServiceManager -[#green]-> ServerManager: 注册请求回调
ServiceManager <- - ServerManager: 注册成功
AposSdkIot <- - ServiceManager: 初始化成功
Network <- - AposSdkIot: 初始化成功
Network -[#orange]> AposSdkIot: 注册事件回调 egg: \n/Sweep/DevStatus(业务型)\n/Common/TimeNtpUpdate(透传型)

==请求执行==
Network -[#green]> AposSdkIot: 执行指令，egg: /Sweep/Volume
AposSdkIot -[#green]> ServerManager: 执行指令
ServerManager -> APOS_SDK: 执行指令
ServerManager <- - APOS_SDK: 执行结果
AposSdkIot <- - ServerManager: 执行结果
Network <- - AposSdkIot: 执行结果
==事件上报==
APOS_SDK -[#blue]> EventManager: 事件触发
EventManager - -> EventManager: 匹配回调
alt 匹配Network
    EventManager -[#orange]-> Network: 执行回调函数
else 匹配ServiceManager
    EventManager -[#deeppink]-> ServiceManager: 执行回调函数
    ServiceManager -[#red]-> EventManager: 发布到Network
    EventManager -[#red]-> SignalQueue: Push
else 匹配失败

end
@enduml

PlantUML version 1.2022.5(Sat Apr 30 18:55:52 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: GBK
Language: zh
Country: CN
--></g></svg>